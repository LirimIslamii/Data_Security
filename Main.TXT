package rsaexample;

import java.io.File;
import java.io.IOException;
import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

import javax.crypto.BadPaddingException;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;

public class Main1 {

  public static void main(String[] args)throws  ArrayIndexOutOfBoundsException, InterruptedException, IOException, NoSuchAlgorithmException, InvalidKeyException, NoSuchPaddingException, IllegalBlockSizeException, BadPaddingException{
        test T = new test();
        T.writeToFile("RSA/publicKey", T.getPublicKey().getEncoded());
        T.writeToFile("RSA/privateKey", T.getPrivateKey().getEncoded());
        
        if(args[0].equals("create-user")) {
        	T.CreateUser(args[1]);
        }
        else if(args[0].equals("delete-user")) {
        	T.Delete(args[1]);
        }
        else if(args[0].equals("export-key")) {
        	if(args.length == 3) {
            	T.Export(args[1], args[2]);
        	}
        }
        else if(args[0].equals("import-key")) {
        	T.Import(args[1], args[2]);
        }
        else if(args[0].equals("write-message")) {
        	if(args.length == 3) {
           		T.Write2(args[1], args[2]);
        	}
        	else {
           		T.Write(args[1], args[2],args[3]);
        	}
        }
        else if(args[0].equals("read-message")) {
        	T.Read_Message(args[1]);
        }
        else {
        	System.out.print("Gabim");
        }
    }
}